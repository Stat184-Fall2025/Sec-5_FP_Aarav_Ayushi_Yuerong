---
title: "2023 NYC Airport Flights Delay Rate Investigation"
author: "Yuerong Shu, Aarav Johri, Ayushi Bisaria"
format: pdf
editor: visual
jupyter: python3
---

## Library

```{r}
library(tidyverse)
library(lubridate)
library(nycflights23)
library(dplyr)
```

## Data cleansing and basic format check

```{r}
Flights <- nycflights23::flights %>%
  select(year, month, day, dep_delay, dep_time, arr_delay, arr_time, origin) %>% # dep-time and arr-time are saved here in case we want to do investigation on stat of what time section of day have the most possibility of delay
  mutate(
    flight_date = make_date(year, month, day) # date compressed into format yyyy-mm-dd using year, month, day columns, more precise to view
  ) %>%
  select(flight_date, dep_delay, dep_time, arr_delay, arr_time, origin)%>%
  filter(!is.na(dep_delay), !is.na(arr_delay)) #filter invalid rows

head(Flights)
```

```{r}
Delay_rates <- Flights %>% 
  summarise(
    dep_delay_rate = mean(dep_delay > 15),  
    arr_delay_rate = mean(arr_delay > 15) # According to U.S. Department of Transportation, only flights arrived 15 minutes later than planned will be considered a delayed flight, though there is no regulation of delayed departure, we will still use 15 minutes rule here
  )
Delay_rates
```
It is obvious that departure delay rate and arrival delay rate shares similar value, suggesting that these 2 values can be highly correlated. 

## Stat table: suggestion needed
What to include in the table except number and proportion of flights taking off from each airport and flight delay rate of each?

## Making datasets only containing flights of one single airport at a time to make graphs
```{r}
JFK_flights <- Flights %>%
  filter(origin == "JFK") %>%              # keep only flights from JFK
  select(flight_date, dep_delay, dep_time, arr_delay, arr_time) 

EWR_flights <- Flights %>%
  filter(origin == "EWR") %>%              # keep only flights from EWR
  select(flight_date, dep_delay, dep_time, arr_delay, arr_time) 

LGA_flights <- Flights %>%
  filter(origin == "LGA") %>%              # keep only flights from LGA
  select(flight_date, dep_delay, dep_time, arr_delay, arr_time) 

```
